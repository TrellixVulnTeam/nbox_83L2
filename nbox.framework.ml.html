<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Subways" href="nbox.subway.html" /><link rel="prev" title="NBX-Build Instances" href="nbox.instance.html" />

    <meta name="generator" content="sphinx-4.4.0, furo 2022.03.04"/>
        <title>nbox.framework.ml - nbox 0.9.7 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=935aa2abcc5c1da4283d1dc201fb1f0add16d23a" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=25ceb02ed1c46dc30f2321ff83e92799f69dfdb9" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">nbox 0.9.7 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">nbox 0.9.7 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="quick.0.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="nbox.cli.html">nbox.cli module</a></li>
<li class="toctree-l1"><a class="reference internal" href="nbox.nbxlib.ops.html">Operators Library</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Commonly used APIs</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="nbox.model.html">NBX-Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="nbox.operator.html">Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="nbox.jobs.html">NBX-Jobs</a></li>
<li class="toctree-l1"><a class="reference internal" href="nbox.instance.html">NBX-Build Instances</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">nbox.framework.ml</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">R&amp;D</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="nbox.subway.html">Subways</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="nbox.framework.html">Pushing Understanding</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">nbox.framework.ml</a></li>
<li class="toctree-l2"><a class="reference internal" href="nbox.framework.on_ml.html">ML Frameworks</a></li>
<li class="toctree-l2"><a class="reference internal" href="nbox.framework.on_operators.html">Framework on Operators</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Engineering</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="nbox.messages.html">nbox RPC support</a></li>
<li class="toctree-l1"><a class="reference internal" href="nbox.sub_utils.ssh.html">Engineering behind SSH</a></li>
<li class="toctree-l1"><a class="reference internal" href="nbox.auth.html">nbox Authentications</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container"><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <div class="section" id="module-nbox.framework.ml">
<span id="nbox-framework-ml"></span><h1>nbox.framework.ml<a class="headerlink" href="#module-nbox.framework.ml" title="Permalink to this headline">#</a></h1>
<div class="section" id="ml-autogen">
<h2>ML Autogen<a class="headerlink" href="#ml-autogen" title="Permalink to this headline">#</a></h2>
<p>This is an autogenerated file DO NOT TOUCH, it’s sole intention is to provide IDEs
a way to index functions and thereby supporting the users with autocompletion.</p>
<p>Generated by: autogen.py
Complements: on_ml.py</p>
<p>Time of generation (UTC): 2022-03-21T07:12:52.019635</p>
<dl class="py class">
<dt class="sig sig-object py" id="nbox.framework.ml.TorchToTorchscript">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nbox.framework.ml.</span></span><span class="sig-name descname"><span class="pre">TorchToTorchscript</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">example_inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_trace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_force_outplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_module_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nbox/framework/ml.html#TorchToTorchscript"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nbox.framework.ml.TorchToTorchscript" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>AUTOGENERATED by <code class="docutils literal notranslate"><span class="pre">nbox</span></code>, some arguments might be missing, USE <code class="docutils literal notranslate"><span class="pre">kwargs</span></code> CAREFULLY!</p>
<p>Trace a function and return an executable  or <code class="xref py py-class docutils literal notranslate"><span class="pre">ScriptFunction</span></code>
that will be optimized using just-in-time compilation. Tracing is ideal for
code that operates only on <code class="docutils literal notranslate"><span class="pre">Tensor</span></code>s and lists, dictionaries, and
tuples of <code class="docutils literal notranslate"><span class="pre">Tensor</span></code>s.</p>
<p>Using <cite>torch.jit.trace</cite> and <cite>torch.jit.trace_module</cite>, you can turn an
existing module or Python function into a TorchScript
<code class="xref py py-class docutils literal notranslate"><span class="pre">ScriptFunction</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ScriptModule</span></code>. You must provide example
inputs, and we run the function, recording the operations performed on all
the tensors.</p>
<ul class="simple">
<li><p>The resulting recording of a standalone function produces <cite>ScriptFunction</cite>.</p></li>
<li><p>The resulting recording of <cite>nn.Module.forward</cite> or <cite>nn.Module</cite> produces
<cite>ScriptModule</cite>.</p></li>
</ul>
<p>This module also contains any parameters that the original
module had as well.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Tracing only correctly records functions and modules which are not data
dependent (e.g., do not have conditionals on data in tensors) and do not have
any untracked external dependencies (e.g., perform input/output or
access global variables). Tracing only records operations done when the given
function is run on the given tensors. Therefore, the returned
<cite>ScriptModule</cite> will always run the same traced graph on any input. This
has some important implications when your module is expected to run
different sets of operations, depending on the input and/or the module
state. For example,</p>
<ul class="simple">
<li><p>Tracing will not record any control-flow like if-statements or loops.
When this control-flow is constant across your module, this is fine
and it often inlines the control-flow decisions. But sometimes the
control-flow is actually part of the model itself. For instance, a
recurrent network is a loop over the (possibly dynamic) length of an
input sequence.</p></li>
<li><p>In the returned <code class="xref py py-class docutils literal notranslate"><span class="pre">ScriptModule</span></code>, operations that have different
behaviors in <code class="docutils literal notranslate"><span class="pre">training</span></code> and <code class="docutils literal notranslate"><span class="pre">eval</span></code> modes will always behave as if
it is in the mode it was in during tracing, no matter which mode the
<cite>ScriptModule</cite> is in.</p></li>
</ul>
<p>In cases like these, tracing would not be appropriate and
<code class="xref py py-func docutils literal notranslate"><span class="pre">scripting</span></code> is a better choice. If you trace
such models, you may silently get incorrect results on subsequent
invocations of the model. The tracer will try to emit warnings when
doing something that may cause an incorrect trace to be produced.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<em>callable</em><em> or </em><em>torch.nn.Module</em>) – A Python function or <cite>torch.nn.Module</cite>
that will be run with <cite>example_inputs</cite>. <cite>func</cite> arguments and return
values  must be tensors or (possibly nested) tuples that contain
tensors. When a module is passed <cite>torch.jit.trace</cite>, only the
<code class="docutils literal notranslate"><span class="pre">forward</span></code> method is run and traced (see <code class="xref py py-func docutils literal notranslate"><span class="pre">torch.jit.trace</span></code> for details).</p></li>
<li><p><strong>example_inputs</strong> (<em>tuple</em><em> or </em><em>torch.Tensor</em>) – A tuple of example inputs that
will be passed to the function while tracing. The resulting trace
can be run with inputs of different types and shapes assuming the
traced operations support those types and shapes. <cite>example_inputs</cite>
may also be a single Tensor in which case it is automatically
wrapped in a tuple.</p></li>
</ul>
</dd>
<dt class="field-even">Keyword Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>check_trace</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>, optional) – Check if the same inputs run through
traced code produce the same outputs. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code>. You might want
to disable this if, for example, your network contains non-
deterministic ops or if you are sure that the network is correct despite
a checker failure.</p></li>
<li><p><strong>check_inputs</strong> (<em>list of tuples</em><em>, </em><em>optional</em>) – A list of tuples of input
arguments that should be used to check the trace against what is
expected. Each tuple is equivalent to a set of input arguments that
would be specified in <code class="docutils literal notranslate"><span class="pre">example_inputs</span></code>. For best results, pass in
a set of checking inputs representative of the space of shapes and
types of inputs you expect the network to see.  If not specified,
the original <code class="docutils literal notranslate"><span class="pre">example_inputs</span></code> are used for checking</p></li>
<li><p><strong>check_tolerance</strong> (<em>float</em><em>, </em><em>optional</em>) – Floating-point comparison tolerance
to use in the checker procedure.  This can be used to relax the
checker strictness in the event that results diverge numerically
for a known reason, such as operator fusion.</p></li>
<li><p><strong>strict</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>, optional) – run the tracer in a strict mode or not
(default: <code class="docutils literal notranslate"><span class="pre">True</span></code>). Only turn this off when you want the tracer to
record your mutable container types (currently <code class="docutils literal notranslate"><span class="pre">list</span></code>/<code class="docutils literal notranslate"><span class="pre">dict</span></code>)
and you are sure that the container you are using in your
problem is a <code class="docutils literal notranslate"><span class="pre">constant</span></code> structure and does not get used as
control flow (if, for) conditions.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>If <cite>func</cite> is <cite>nn.Module</cite> or <code class="docutils literal notranslate"><span class="pre">forward</span></code> of <cite>nn.Module</cite>, <cite>trace</cite> returns
a <code class="xref py py-class docutils literal notranslate"><span class="pre">ScriptModule</span></code> object with a single <code class="docutils literal notranslate"><span class="pre">forward</span></code> method
containing the traced code.  The returned <cite>ScriptModule</cite> will
have the same set of sub-modules and parameters as the original
<code class="docutils literal notranslate"><span class="pre">nn.Module</span></code>.  If <code class="docutils literal notranslate"><span class="pre">func</span></code> is a standalone function, <code class="docutils literal notranslate"><span class="pre">trace</span></code>
returns <cite>ScriptFunction</cite>.</p>
</dd>
</dl>
<p>Example (tracing a function):</p>
<p>Example (tracing an existing module):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>

<span class="k">class</span> <span class="nc">Net</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Net</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conv</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">conv</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">n</span> <span class="o">=</span> <span class="n">Net</span><span class="p">()</span>
<span class="n">example_weight</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">example_forward_input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="c1"># Trace a specific method and construct `ScriptModule` with</span>
<span class="c1"># a single `forward` method</span>
<span class="n">module</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">jit</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">forward</span><span class="p">,</span> <span class="n">example_forward_input</span><span class="p">)</span>

<span class="c1"># Trace a module (implicitly traces `forward`) and construct a</span>
<span class="c1"># `ScriptModule` with a single `forward` method</span>
<span class="n">module</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">jit</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">example_forward_input</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="nbox.framework.ml.TorchscriptToTorch">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nbox.framework.ml.</span></span><span class="sig-name descname"><span class="pre">TorchscriptToTorch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">map_location</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_extra_files</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nbox/framework/ml.html#TorchscriptToTorch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nbox.framework.ml.TorchscriptToTorch" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>AUTOGENERATED by <code class="docutils literal notranslate"><span class="pre">nbox</span></code>, some arguments might be missing, USE <code class="docutils literal notranslate"><span class="pre">kwargs</span></code> CAREFULLY!</p>
<p>Load a <code class="xref py py-class docutils literal notranslate"><span class="pre">ScriptModule</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ScriptFunction</span></code> previously
saved with <code class="xref py py-func docutils literal notranslate"><span class="pre">torch.jit.save</span></code></p>
<p>All previously saved modules, no matter their device, are first loaded onto CPU,
and then are moved to the devices they were saved from. If this fails (e.g.
because the run time system doesn’t have certain devices), an exception is
raised.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> – a file-like object (has to implement read, readline, tell, and seek),
or a string containing a file name</p></li>
<li><p><strong>map_location</strong> (<em>string</em><em> or </em><em>torch.device</em>) – A simplified version of
<code class="docutils literal notranslate"><span class="pre">map_location</span></code> in <cite>torch.jit.save</cite> used to dynamically remap
storages to an alternative set of devices.</p></li>
<li><p><strong>_extra_files</strong> (<em>dictionary of filename to content</em>) – The extra
filenames given in the map would be loaded and their content
would be stored in the provided map.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <code class="xref py py-class docutils literal notranslate"><span class="pre">ScriptModule</span></code> object.</p>
</dd>
</dl>
<p>Example:</p>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="nbox.framework.ml.TorchToOnnx">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nbox.framework.ml.</span></span><span class="sig-name descname"><span class="pre">TorchToOnnx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">export_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">operator_export_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opset_version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_constant_folding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamic_axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_initializers_as_inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_opsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">export_modules_as_functions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nbox/framework/ml.html#TorchToOnnx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nbox.framework.ml.TorchToOnnx" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>AUTOGENERATED by <code class="docutils literal notranslate"><span class="pre">nbox</span></code>, some arguments might be missing, USE <code class="docutils literal notranslate"><span class="pre">kwargs</span></code> CAREFULLY!</p>
<p>Exports a model into ONNX format. If <code class="docutils literal notranslate"><span class="pre">model</span></code> is not a
<code class="xref py py-class docutils literal notranslate"><span class="pre">torch.jit.ScriptModule</span></code> nor a <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.jit.ScriptFunction</span></code>, this runs
<code class="docutils literal notranslate"><span class="pre">model</span></code> once in order to convert it to a TorchScript graph to be exported
(the equivalent of <code class="xref py py-func docutils literal notranslate"><span class="pre">torch.jit.trace()</span></code>). Thus this has the same limited support
for dynamic control flow as <code class="xref py py-func docutils literal notranslate"><span class="pre">torch.jit.trace()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>torch.nn.Module</em><em>, </em><em>torch.jit.ScriptModule</em><em> or </em><em>torch.jit.ScriptFunction</em>) – the model to be exported.</p></li>
<li><p><strong>args</strong> (<em>tuple</em><em> or </em><em>torch.Tensor</em>) – <p>args can be structured either as:</p>
<ol class="arabic">
<li><p>ONLY A TUPLE OF ARGUMENTS:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ol>
<p>The tuple should contain model inputs such that <code class="docutils literal notranslate"><span class="pre">model(*args)</span></code> is a valid
invocation of the model. Any non-Tensor arguments will be hard-coded into the
exported model; any Tensor arguments will become inputs of the exported model,
in the order they occur in the tuple.</p>
<ol class="arabic" start="2">
<li><p>A TENSOR:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">args</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</li>
</ol>
<p>This is equivalent to a 1-ary tuple of that Tensor.</p>
<ol class="arabic" start="3">
<li><p>A TUPLE OF ARGUMENTS ENDING WITH A DICTIONARY OF NAMED ARGUMENTS:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span>
        <span class="p">{</span><span class="s1">'y'</span><span class="p">:</span> <span class="n">input_y</span><span class="p">,</span>
         <span class="s1">'z'</span><span class="p">:</span> <span class="n">input_z</span><span class="p">})</span>
</pre></div>
</div>
</li>
</ol>
<p>All but the last element of the tuple will be passed as non-keyword arguments,
and named arguments will be set from the last element. If a named argument is
not present in the dictionary, it is assigned the default value, or None if a
default value is not provided.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If a dictionary is the last element of the args tuple, it will be
interpreted as containing named arguments. In order to pass a dict as the
last non-keyword arg, provide an empty dict as the last element of the args
tuple. For example, instead of:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">torch</span><span class="o">.</span><span class="n">onnx</span><span class="o">.</span><span class="n">export</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span>
    <span class="p">(</span><span class="n">x</span><span class="p">,</span>
     <span class="c1"># WRONG: will be interpreted as named arguments</span>
     <span class="p">{</span><span class="n">y</span><span class="p">:</span> <span class="n">z</span><span class="p">}),</span>
    <span class="s2">"test.onnx.pb"</span><span class="p">)</span>
</pre></div>
</div>
<p>Write:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">torch</span><span class="o">.</span><span class="n">onnx</span><span class="o">.</span><span class="n">export</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span>
    <span class="p">(</span><span class="n">x</span><span class="p">,</span>
     <span class="p">{</span><span class="n">y</span><span class="p">:</span> <span class="n">z</span><span class="p">},</span>
     <span class="p">{}),</span>
    <span class="s2">"test.onnx.pb"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</p></li>
<li><p><strong>f</strong> – a file-like object (such that <code class="docutils literal notranslate"><span class="pre">f.fileno()</span></code> returns a file descriptor)
or a string containing a file name.  A binary protocol buffer will be written
to this file.</p></li>
<li><p><strong>export_params</strong> (<em>bool</em><em>, </em><em>default True</em>) – if True, all parameters will
be exported. Set this to False if you want to export an untrained model.
In this case, the exported model will first take all of its parameters
as arguments, with the ordering as specified by <code class="docutils literal notranslate"><span class="pre">model.state_dict().values()</span></code></p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>default False</em>) – if True, prints a description of the
model being exported to stdout. In addition, the final ONNX graph will include the
field <code class="docutils literal notranslate"><span class="pre">doc_string`</span></code> from the exported model which mentions the source code locations
for <code class="docutils literal notranslate"><span class="pre">model</span></code>.</p></li>
<li><p><strong>training</strong> (<em>enum</em><em>, </em><em>default TrainingMode.EVAL</em>) – <ul>
<li><p><code class="docutils literal notranslate"><span class="pre">TrainingMode.EVAL</span></code>: export the model in inference mode.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TrainingMode.PRESERVE</span></code>: export the model in inference mode if model.training is
False and in training mode if model.training is True.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TrainingMode.TRAINING</span></code>: export the model in training mode. Disables optimizations
which might interfere with training.</p></li>
</ul>
</p></li>
<li><p><strong>input_names</strong> (<em>list of str</em><em>, </em><em>default empty list</em>) – names to assign to the
input nodes of the graph, in order.</p></li>
<li><p><strong>output_names</strong> (<em>list of str</em><em>, </em><em>default empty list</em>) – names to assign to the
output nodes of the graph, in order.</p></li>
<li><p><strong>operator_export_type</strong> (<em>enum</em><em>, </em><em>default None</em>) – <p>None usually means <code class="docutils literal notranslate"><span class="pre">OperatorExportTypes.ONNX</span></code>.
However if PyTorch was built with <code class="docutils literal notranslate"><span class="pre">-DPYTORCH_ONNX_CAFFE2_BUNDLE</span></code>, None means
<code class="docutils literal notranslate"><span class="pre">OperatorExportTypes.ONNX_ATEN_FALLBACK</span></code>.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">OperatorExportTypes.ONNX</span></code>: Export all ops as regular ONNX ops
(in the default opset domain).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">OperatorExportTypes.ONNX_FALLTHROUGH</span></code>: Try to convert all ops
to standard ONNX ops in the default opset domain. If unable to do so
(e.g. because support has not been added to convert a particular torch op to ONNX),
fall back to exporting the op into a custom opset domain without conversion. Applies
to <a class="reference external" href="https://pytorch.org/tutorials/advanced/torch_script_custom_ops.html">custom ops</a>
as well as ATen ops. For the exported model to be usable, the runtime must support
these non-standard ops.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">OperatorExportTypes.ONNX_ATEN</span></code>: All ATen ops (in the TorchScript namespace “aten”)
are exported as ATen ops (in opset domain “org.pytorch.aten”).
<a class="reference external" href="https://pytorch.org/cppdocs/#aten">ATen</a> is PyTorch’s built-in tensor library, so
this instructs the runtime to use PyTorch’s implementation of these ops.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Models exported this way are probably runnable only by Caffe2.</p>
</div>
<p>This may be useful if the numeric differences in implementations of operators are
causing large differences in behavior between PyTorch and Caffe2 (which is more
common on untrained models).</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">OperatorExportTypes.ONNX_ATEN_FALLBACK</span></code>: Try to export each ATen op
(in the TorchScript namespace “aten”) as a regular ONNX op. If we are unable to do so
(e.g. because support has not been added to convert a particular torch op to ONNX),
fall back to exporting an ATen op. See documentation on OperatorExportTypes.ONNX_ATEN for
context.
For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span><span class="p">(</span><span class="o">%</span><span class="mi">0</span> <span class="p">:</span> <span class="n">Float</span><span class="p">):</span>
  <span class="o">%</span><span class="mi">3</span> <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">prim</span><span class="p">::</span><span class="n">Constant</span><span class="p">[</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">]()</span>
  <span class="c1"># conversion unsupported</span>
  <span class="o">%</span><span class="mi">4</span> <span class="p">:</span> <span class="n">Float</span> <span class="o">=</span> <span class="n">aten</span><span class="p">::</span><span class="n">triu</span><span class="p">(</span><span class="o">%</span><span class="mi">0</span><span class="p">,</span> <span class="o">%</span><span class="mi">3</span><span class="p">)</span>
  <span class="c1"># conversion supported</span>
  <span class="o">%</span><span class="mi">5</span> <span class="p">:</span> <span class="n">Float</span> <span class="o">=</span> <span class="n">aten</span><span class="p">::</span><span class="n">mul</span><span class="p">(</span><span class="o">%</span><span class="mi">4</span><span class="p">,</span> <span class="o">%</span><span class="mi">0</span><span class="p">)</span>
  <span class="k">return</span> <span class="p">(</span><span class="o">%</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<p>Assuming <code class="docutils literal notranslate"><span class="pre">aten::triu</span></code> is not supported in ONNX, this will be exported as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span><span class="p">(</span><span class="o">%</span><span class="mi">0</span> <span class="p">:</span> <span class="n">Float</span><span class="p">):</span>
  <span class="o">%</span><span class="mi">1</span> <span class="p">:</span> <span class="n">Long</span><span class="p">()</span> <span class="o">=</span> <span class="n">onnx</span><span class="p">::</span><span class="n">Constant</span><span class="p">[</span><span class="n">value</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">}]()</span>
  <span class="c1"># not converted</span>
  <span class="o">%</span><span class="mi">2</span> <span class="p">:</span> <span class="n">Float</span> <span class="o">=</span> <span class="n">aten</span><span class="p">::</span><span class="n">ATen</span><span class="p">[</span><span class="n">operator</span><span class="o">=</span><span class="s2">"triu"</span><span class="p">](</span><span class="o">%</span><span class="mi">0</span><span class="p">,</span> <span class="o">%</span><span class="mi">1</span><span class="p">)</span>
  <span class="c1"># converted</span>
  <span class="o">%</span><span class="mi">3</span> <span class="p">:</span> <span class="n">Float</span> <span class="o">=</span> <span class="n">onnx</span><span class="p">::</span><span class="n">Mul</span><span class="p">(</span><span class="o">%</span><span class="mi">2</span><span class="p">,</span> <span class="o">%</span><span class="mi">0</span><span class="p">)</span>
  <span class="k">return</span> <span class="p">(</span><span class="o">%</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>If PyTorch was built with Caffe2 (i.e. with <code class="docutils literal notranslate"><span class="pre">BUILD_CAFFE2=1</span></code>), then
Caffe2-specific behavior will be enabled, including special support
for ops are produced by the modules described in
<a class="reference external" href="https://pytorch.org/docs/stable/quantization.html">Quantization</a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Models exported this way are probably runnable only by Caffe2.</p>
</div>
</li>
</ul>
</p></li>
<li><p><strong>opset_version</strong> (<em>int</em><em>, </em><em>default 9</em>) – The version of the
<a class="reference external" href="https://github.com/onnx/onnx/blob/master/docs/Operators.md">default (ai.onnx) opset</a>
to target. Must be &gt;= 7 and &lt;= 15.</p></li>
<li><p><strong>do_constant_folding</strong> (<em>bool</em><em>, </em><em>default True</em>) – Apply the constant-folding optimization.
Constant-folding will replace some of the ops that have all constant inputs
with pre-computed constant nodes.</p></li>
<li><p><strong>dynamic_axes</strong> (<em>dict&lt;string</em><em>, </em><em>dict&lt;int</em><em>, </em><em>string&gt;&gt;</em><em> or </em><em>dict&lt;string</em><em>, </em><em>list</em><em>(</em><em>int</em><em>)</em><em>&gt;</em><em>, </em><em>default empty dict</em>) – <p>By default the exported model will have the shapes of all input and output tensors
set to exactly match those given in <code class="docutils literal notranslate"><span class="pre">args</span></code>. To specify axes of tensors as
dynamic (i.e. known only at run-time), set <code class="docutils literal notranslate"><span class="pre">dynamic_axes</span></code> to a dict with schema:</p>
<ul>
<li><p>KEY (str): an input or output name. Each name must also be provided in <code class="docutils literal notranslate"><span class="pre">input_names</span></code> or
<code class="docutils literal notranslate"><span class="pre">output_names</span></code>.</p></li>
<li><p>VALUE (dict or list): If a dict, keys are axis indices and values are axis names. If a
list, each element is an axis index.</p></li>
</ul>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SumModule</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">torch</span><span class="o">.</span><span class="n">onnx</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">SumModule</span><span class="p">(),</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),),</span> <span class="s2">"onnx.pb"</span><span class="p">,</span>
                  <span class="n">input_names</span><span class="o">=</span><span class="p">[</span><span class="s2">"x"</span><span class="p">],</span> <span class="n">output_names</span><span class="o">=</span><span class="p">[</span><span class="s2">"sum"</span><span class="p">])</span>
</pre></div>
</div>
<p>Produces:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">input</span> <span class="p">{</span>
  <span class="n">name</span><span class="p">:</span> <span class="s2">"x"</span>
  <span class="o">...</span>
      <span class="n">shape</span> <span class="p">{</span>
        <span class="n">dim</span> <span class="p">{</span>
          <span class="n">dim_value</span><span class="p">:</span> <span class="mi">2</span>  <span class="c1"># axis 0</span>
        <span class="p">}</span>
        <span class="n">dim</span> <span class="p">{</span>
          <span class="n">dim_value</span><span class="p">:</span> <span class="mi">2</span>  <span class="c1"># axis 1</span>
<span class="o">...</span>
<span class="n">output</span> <span class="p">{</span>
  <span class="n">name</span><span class="p">:</span> <span class="s2">"sum"</span>
  <span class="o">...</span>
      <span class="n">shape</span> <span class="p">{</span>
        <span class="n">dim</span> <span class="p">{</span>
          <span class="n">dim_value</span><span class="p">:</span> <span class="mi">2</span>  <span class="c1"># axis 0</span>
<span class="o">...</span>
</pre></div>
</div>
<p>While:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">torch</span><span class="o">.</span><span class="n">onnx</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">SumModule</span><span class="p">(),</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),),</span> <span class="s2">"onnx.pb"</span><span class="p">,</span>
                  <span class="n">input_names</span><span class="o">=</span><span class="p">[</span><span class="s2">"x"</span><span class="p">],</span> <span class="n">output_names</span><span class="o">=</span><span class="p">[</span><span class="s2">"sum"</span><span class="p">],</span>
                  <span class="n">dynamic_axes</span><span class="o">=</span><span class="p">{</span>
                      <span class="c1"># dict value: manually named axes</span>
                      <span class="s2">"x"</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">"my_custom_axis_name"</span><span class="p">},</span>
                      <span class="c1"># list value: automatic names</span>
                      <span class="s2">"sum"</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                  <span class="p">})</span>
</pre></div>
</div>
<p>Produces:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">input</span> <span class="p">{</span>
  <span class="n">name</span><span class="p">:</span> <span class="s2">"x"</span>
  <span class="o">...</span>
      <span class="n">shape</span> <span class="p">{</span>
        <span class="n">dim</span> <span class="p">{</span>
          <span class="n">dim_param</span><span class="p">:</span> <span class="s2">"my_custom_axis_name"</span>  <span class="c1"># axis 0</span>
        <span class="p">}</span>
        <span class="n">dim</span> <span class="p">{</span>
          <span class="n">dim_value</span><span class="p">:</span> <span class="mi">2</span>  <span class="c1"># axis 1</span>
<span class="o">...</span>
<span class="n">output</span> <span class="p">{</span>
  <span class="n">name</span><span class="p">:</span> <span class="s2">"sum"</span>
  <span class="o">...</span>
      <span class="n">shape</span> <span class="p">{</span>
        <span class="n">dim</span> <span class="p">{</span>
          <span class="n">dim_param</span><span class="p">:</span> <span class="s2">"sum_dynamic_axes_1"</span>  <span class="c1"># axis 0</span>
<span class="o">...</span>
</pre></div>
</div>
</p></li>
<li><p><strong>keep_initializers_as_inputs</strong> (<em>bool</em><em>, </em><em>default None</em>) – <p>If True, all the
initializers (typically corresponding to parameters) in the
exported graph will also be added as inputs to the graph. If False,
then initializers are not added as inputs to the graph, and only
the non-parameter inputs are added as inputs.
This may allow for better optimizations (e.g. constant folding) by
backends/runtimes.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">opset_version</span> <span class="pre">&lt;</span> <span class="pre">9</span></code>, initializers MUST be part of graph
inputs and this argument will be ignored and the behavior will be
equivalent to setting this argument to True.</p>
<p>If None, then the behavior is chosen automatically as follows:</p>
<ul>
<li><p>If <code class="docutils literal notranslate"><span class="pre">operator_export_type=OperatorExportTypes.ONNX</span></code>, the behavior is equivalent
to setting this argument to False.</p></li>
<li><p>Else, the behavior is equivalent to setting this argument to True.</p></li>
</ul>
</p></li>
<li><p><strong>custom_opsets</strong> (<em>dict&lt;str</em><em>, </em><em>int&gt;</em><em>, </em><em>default empty dict</em>) – <p>A dict with schema:</p>
<ul>
<li><p>KEY (str): opset domain name</p></li>
<li><p>VALUE (int): opset version</p></li>
</ul>
<p>If a custom opset is referenced by <code class="docutils literal notranslate"><span class="pre">model</span></code> but not mentioned in this dictionary,
the opset version is set to 1. Only custom opset domain name and version should be
indicated through this argument.</p>
</p></li>
<li><p><strong>export_modules_as_functions</strong> (<em>bool</em><em> or </em><em>set of type of nn.Module</em><em>, </em><em>default False</em>) – <p>Flag to enable
exporting all <code class="docutils literal notranslate"><span class="pre">nn.Module</span></code> forward calls as local functions in ONNX. Or a set to indicate the
particular types of modules to export as local functions in ONNX.
This feature requires <code class="docutils literal notranslate"><span class="pre">opset_version</span></code> &gt;= 15, otherwise the export will fail. This is because
<code class="docutils literal notranslate"><span class="pre">opset_version</span></code> &lt; 15 implies IR version &lt; 8, which means no local function support.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">False``(default):</span> <span class="pre">export</span> <span class="pre">``nn.Module</span></code> forward calls as fine grained nodes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: export all <code class="docutils literal notranslate"><span class="pre">nn.Module</span></code> forward calls as local function nodes.</p></li>
<li><p>Set of type of nn.Module: export <code class="docutils literal notranslate"><span class="pre">nn.Module</span></code> forward calls as local function nodes,
only if the type of the <code class="docutils literal notranslate"><span class="pre">nn.Module</span></code> is found in the set.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>CheckerError</strong> – If the ONNX checker detects an invalid ONNX graph. Will still export the
    model to the file <code class="docutils literal notranslate"><span class="pre">f</span></code> even if this is raised.</p>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="nbox.framework.ml.Framework_torch">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nbox.framework.ml.</span></span><span class="sig-name descname"><span class="pre">Framework_torch</span></span><a class="reference internal" href="_modules/nbox/framework/ml.html#Framework_torch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nbox.framework.ml.Framework_torch" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="nbox.framework.ml.Framework_torch.torch_to_torchscript">
<span class="sig-name descname"><span class="pre">torch_to_torchscript</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbox_options</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="nbox.framework.on_ml.html#nbox.framework.on_ml.NboxOptions" title="nbox.framework.on_ml.NboxOptions"><span class="pre">nbox.framework.on_ml.NboxOptions</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">nbox.framework.protos.model_spec_pb2.ModelSpec</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/nbox/framework/ml.html#Framework_torch.torch_to_torchscript"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nbox.framework.ml.Framework_torch.torch_to_torchscript" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>user_options</strong> (<a class="reference internal" href="#nbox.framework.ml.TorchToTorchscript" title="nbox.framework.ml.TorchToTorchscript"><em>nbox.framework.ml.TorchToTorchscript</em></a>) – Variables to be filled by the user</p></li>
<li><p><strong>_nbox_options</strong> (<em>nbox.framework.NboxOptions</em>) – Options to be used by NBX-Services</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>when serialising the model returns <code class="docutils literal notranslate"><span class="pre">ModelSpec</span></code> else returns the <code class="docutils literal notranslate"><span class="pre">model</span></code> in <code class="docutils literal notranslate"><span class="pre">nbox.Model</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="nbox.framework.ml.Framework_torch.torchscript_to_torch">
<span class="sig-name descname"><span class="pre">torchscript_to_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbox_options</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="nbox.framework.on_ml.html#nbox.framework.on_ml.NboxOptions" title="nbox.framework.on_ml.NboxOptions"><span class="pre">nbox.framework.on_ml.NboxOptions</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">nbox.framework.protos.model_spec_pb2.ModelSpec</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/nbox/framework/ml.html#Framework_torch.torchscript_to_torch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nbox.framework.ml.Framework_torch.torchscript_to_torch" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>user_options</strong> (<a class="reference internal" href="#nbox.framework.ml.TorchscriptToTorch" title="nbox.framework.ml.TorchscriptToTorch"><em>nbox.framework.ml.TorchscriptToTorch</em></a>) – Variables to be filled by the user</p></li>
<li><p><strong>_nbox_options</strong> (<em>nbox.framework.NboxOptions</em>) – Options to be used by NBX-Services</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>when serialising the model returns <code class="docutils literal notranslate"><span class="pre">ModelSpec</span></code> else returns the <code class="docutils literal notranslate"><span class="pre">model</span></code> in <code class="docutils literal notranslate"><span class="pre">nbox.Model</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="nbox.framework.ml.Framework_torch.torch_to_onnx">
<span class="sig-name descname"><span class="pre">torch_to_onnx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbox_options</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="nbox.framework.on_ml.html#nbox.framework.on_ml.NboxOptions" title="nbox.framework.on_ml.NboxOptions"><span class="pre">nbox.framework.on_ml.NboxOptions</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">nbox.framework.protos.model_spec_pb2.ModelSpec</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/nbox/framework/ml.html#Framework_torch.torch_to_onnx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nbox.framework.ml.Framework_torch.torch_to_onnx" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>user_options</strong> (<a class="reference internal" href="#nbox.framework.ml.TorchToOnnx" title="nbox.framework.ml.TorchToOnnx"><em>nbox.framework.ml.TorchToOnnx</em></a>) – Variables to be filled by the user</p></li>
<li><p><strong>_nbox_options</strong> (<em>nbox.framework.NboxOptions</em>) – Options to be used by NBX-Services</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>when serialising the model returns <code class="docutils literal notranslate"><span class="pre">ModelSpec</span></code> else returns the <code class="docutils literal notranslate"><span class="pre">model</span></code> in <code class="docutils literal notranslate"><span class="pre">nbox.Model</span></code></p>
</dd>
</dl>
</dd></dl>
</dd></dl>
</div>
</div>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="nbox.subway.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Subways</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="nbox.instance.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">NBX-Build Instances</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2021-22, nimblebox.ai
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">nbox.framework.ml</a><ul>
<li><a class="reference internal" href="#ml-autogen">ML Autogen</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/furo.js"></script>
    </body>
</html>